with ortsteile as
(
    select ortsteil,
    to_char(to_timestamp(timestamp/1000), 'yyyy-mm-dd') as Datum,
    count(*) as Anzahl
    from tree_history
    where timestamp > 1617307710000
    group by ortsteil, timestamp
    order by ortsteil, timestamp
)
select ot0.Anzahl as "Anger-Crottendorf", ot1.Anzahl as "Neustadt-Neuschönefeld", ot2.Anzahl as "Reudnitz-Thonberg", ot3.Anzahl as "Volkmarsdorf" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Anger-Crottendorf') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Neustadt-Neuschönefeld') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Reudnitz-Thonberg') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Volkmarsdorf') as ot3 on ot2.Datum = ot3.Datum