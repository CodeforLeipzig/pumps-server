with ortsteile as
(
    select ortsteil,
    to_char(to_timestamp(timestamp/1000), 'yyyy-mm-dd') as Datum,
    count(*) as Anzahl
    from tree_history
    where timestamp > 1617307710000
    group by ortsteil, timestamp
    order by ortsteil, timestamp
)

-- query 0-10
select ot0.Datum, ot0.Anzahl as "Althen-Kleinpösna", ot1.Anzahl as "Altlindenau", ot2.Anzahl as "Anger-Crottendorf", ot3.Anzahl as "Baalsdorf", ot4.Anzahl as "Burghausen-Rückmarsdorf", ot5.Anzahl as "Böhlitz-Ehrenberg", ot6.Anzahl as "Connewitz", ot7.Anzahl as "Dölitz-Dösen", ot8.Anzahl as "Engelsdorf", ot9.Anzahl as "Eutritzsch" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Althen-Kleinpösna') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Altlindenau') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Anger-Crottendorf') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Baalsdorf') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Burghausen-Rückmarsdorf') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Böhlitz-Ehrenberg') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Connewitz') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Dölitz-Dösen') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Engelsdorf') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Eutritzsch') as ot9 on ot8.Datum = ot9.Datum

-- query 10-20
select ot0.Datum, ot0.Anzahl as "Gohlis-Mitte", ot1.Anzahl as "Gohlis-Nord", ot2.Anzahl as "Gohlis-Süd", ot3.Anzahl as "Großzschocher", ot4.Anzahl as "Grünau-Mitte", ot5.Anzahl as "Grünau-Nord", ot6.Anzahl as "Grünau-Ost", ot7.Anzahl as "Grünau-Siedlung", ot8.Anzahl as "Hartmannsdorf-Knautnaundorf", ot9.Anzahl as "Heiterblick" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Gohlis-Mitte') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Gohlis-Nord') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Gohlis-Süd') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Großzschocher') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Grünau-Mitte') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Grünau-Nord') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Grünau-Ost') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Grünau-Siedlung') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Hartmannsdorf-Knautnaundorf') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Heiterblick') as ot9 on ot8.Datum = ot9.Datum

-- query 20-30
select ot0.Datum, ot0.Anzahl as "Holzhausen", ot1.Anzahl as "Kleinzschocher", ot2.Anzahl as "Knautkleeberg-Knauthain", ot3.Anzahl as "Lausen-Grünau", ot4.Anzahl as "Leutzsch", ot5.Anzahl as "Liebertwolkwitz", ot6.Anzahl as "Lindenau", ot7.Anzahl as "Lindenthal", ot8.Anzahl as "Lößnig", ot9.Anzahl as "Lützschena-Stahmeln" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Holzhausen') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Kleinzschocher') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Knautkleeberg-Knauthain') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Lausen-Grünau') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Leutzsch') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Liebertwolkwitz') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Lindenau') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Lindenthal') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Lößnig') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Lützschena-Stahmeln') as ot9 on ot8.Datum = ot9.Datum

-- query 30-40
select ot0.Datum, ot0.Anzahl as "Marienbrunn", ot1.Anzahl as "Meusdorf", ot2.Anzahl as "Miltitz", ot3.Anzahl as "Mockau-Nord", ot4.Anzahl as "Mockau-Süd", ot5.Anzahl as "Möckern", ot6.Anzahl as "Mölkau", ot7.Anzahl as "Neulindenau", ot8.Anzahl as "Neustadt-Neuschönefeld", ot9.Anzahl as "Paunsdorf" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Marienbrunn') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Meusdorf') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Miltitz') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Mockau-Nord') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Mockau-Süd') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Möckern') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Mölkau') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Neulindenau') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Neustadt-Neuschönefeld') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Paunsdorf') as ot9 on ot8.Datum = ot9.Datum

-- query 40-50
select ot0.Datum, ot0.Anzahl as "Plagwitz", ot1.Anzahl as "Plaußig-Portitz", ot2.Anzahl as "Probstheida", ot3.Anzahl as "Reudnitz-Thonberg", ot4.Anzahl as "Schleußig", ot5.Anzahl as "Schönau", ot6.Anzahl as "Schönefeld-Abtnaundorf", ot7.Anzahl as "Schönefeld-Ost", ot8.Anzahl as "Seehausen", ot9.Anzahl as "Sellerhausen-Stünz" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Plagwitz') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Plaußig-Portitz') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Probstheida') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Reudnitz-Thonberg') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Schleußig') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Schönau') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Schönefeld-Abtnaundorf') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Schönefeld-Ost') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Seehausen') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Sellerhausen-Stünz') as ot9 on ot8.Datum = ot9.Datum

-- query 50-63
select ot0.Datum, ot0.Anzahl as "Stötteritz", ot1.Anzahl as "Südvorstadt", ot2.Anzahl as "Thekla", ot3.Anzahl as "Volkmarsdorf", ot4.Anzahl as "Wahren", ot5.Anzahl as "Wiederitzsch", ot6.Anzahl as "Zentrum", ot7.Anzahl as "Zentrum-Nord", ot8.Anzahl as "Zentrum-Nordwest", ot9.Anzahl as "Zentrum-Ost", ot10.Anzahl as "Zentrum-Süd", ot11.Anzahl as "Zentrum-Südost", ot12.Anzahl as "Zentrum-West" from
(select Datum, Anzahl from ortsteile where ortsteil = 'Stötteritz') as ot0 join (select Datum, Anzahl from ortsteile where ortsteil = 'Südvorstadt') as ot1 on ot0.Datum = ot1.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Thekla') as ot2 on ot1.Datum = ot2.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Volkmarsdorf') as ot3 on ot2.Datum = ot3.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Wahren') as ot4 on ot3.Datum = ot4.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Wiederitzsch') as ot5 on ot4.Datum = ot5.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum') as ot6 on ot5.Datum = ot6.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-Nord') as ot7 on ot6.Datum = ot7.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-Nordwest') as ot8 on ot7.Datum = ot8.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-Ost') as ot9 on ot8.Datum = ot9.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-Süd') as ot10 on ot9.Datum = ot10.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-Südost') as ot11 on ot10.Datum = ot11.Datum  join (select Datum, Anzahl from ortsteile where ortsteil = 'Zentrum-West') as ot12 on ot11.Datum = ot12.Datum

